<div class="pagination-table-comments-moderation" url="{{ path('pagination_comments_moderation') }}">
    {% if commentsFlagged|length != 0 %}
        <div class="table-responsive-vertical shadow-z-1">
            <table class="table table-hover table-mc-default">
                <thead>
                <tr>
                    <th>Article</th>
                    <th>Utilisateur</th>
                    <th>Commentaire</th>
                    <th>Date du commentaire</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                {% for commentFlagged in commentsFlagged %}
                    <tr>
                        <td data-title="Article">
                            {{ commentFlagged.post.title|slice(0, 10) }}{% if commentFlagged.post.title|length > 10 %}...{% endif %}
                        </td>
                        <td data-title="Utilisateur">
                            {{ commentFlagged.author.username }}
                        </td>
                        <td data-title="Commentaire">
                            {{ commentFlagged.message|slice(0, 15) }}{% if commentFlagged.post.title|length > 15 %}...{% endif %}
                        </td>
                        <td data-title="Date du commentaire">
                            {{ commentFlagged.date|date('d/m/Y à H:m') }}
                        </td>
                        <td class="action" data-title="Action">
                            <a href="#" data-toggle="modal" data-target="#viewDetailsCommentModal{{ commentFlagged.id }}">
                                <i class="fa fa-eye" aria-hidden="true"></i>
                            </a>
                            <a href="#" data-toggle="modal" data-target="#deleteCommentModal{{ commentFlagged.id }}">
                                <i class="fa fa-times" aria-hidden="true"></i>
                            </a>
                        </td>
                    </tr>
                    {# ------------------------------------MODALE DETAILS COMMENTAIRE---------------------------------------- #}
                    <div class="modal fade" id="viewDetailsCommentModal{{ commentFlagged.id }}" tabindex="-1" role="dialog" aria-labelledby="viewDetailsCommentModal{{ commentFlagged.id }}Label" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="viewDetailsCommentModal{{ commentFlagged.id }}Label">Détails du commentaire</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true"><img src="{{ asset('img/dashboard/btn-close.png') }}" alt="close"></span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Article : {{ commentFlagged.post.title }}</p>
                                    <p>Nombre de signalement recu : {{ commentFlagged.flagged }}</p>
                                    <p>Commentaire signalé : {{ commentFlagged.message }}</p>
                                    {% if commentFlagged.parent != null %}
                                        <p>En réponse à  : {{ commentFlagged.parent.message }}</p>
                                    {% endif %}
                                    <button class="btn btn-default btn-approuve-comment" href="{{ path('comment_approuved', {'id': commentFlagged.id }) }}" data-dismiss="modal">Approuver</button>
                                    <button class="btn btn-default btn-delete-comment" href="{{ path('comment_delete', {'id': commentFlagged.id}) }}" data-dismiss="modal"> Supprimer</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {# ------------------------------------MODALE SUPPRESSION COMMENTAIRE---------------------------------------- #}
                    <div class="modal fade" id="deleteCommentModal{{ commentFlagged.id }}" tabindex="-1" role="dialog" aria-labelledby="deleteCommentModal{{ commentFlagged.id }}Label" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="deleteCommentModal{{ commentFlagged.id }}Label"></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true"><img src="{{ asset('img/dashboard/btn-close.png') }}" alt="close"></span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <h5>Etes vous sur de vouloir supprimer ce commentaire ?</h5>
                                    {% if commentFlagged.children|length == 0 %}
                                        <p>En supprimant ce commentaire vous supprimerez également toutes les réponses associées</p>
                                    {% endif %}
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">NON</button>
                                    <button href="{{ path('comment_delete', {'id': commentFlagged.id}) }}" class="btn btn-default btn-delete-comment" data-dismiss="modal">OUI</button>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                </tbody>
            </table>
        </div>

        {# div englobant le paginator et contenant la route à prendre pour la requete Ajax de pagination#}
        <div id="paginationCommentsModeration" class="row">
            {# display navigation #}
            <div class="navigation mx-auto">
                {{ knp_pagination_render(commentsFlagged) }}
            </div>
        </div>
    {% else %}
        Aucun commentaire n'a été signalé.
    {% endif %}
</div>
